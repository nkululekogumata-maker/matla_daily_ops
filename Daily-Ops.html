<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#0f1419">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Matla JFA">
    <title>Matla Life - JFA Daily Operations</title>
    <link rel="stylesheet" href="styles_2.css?v=108">
    <link rel="manifest" href="manifest.json?v=73">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="matla-life-logo2.png" type="image/png">
    <link rel="apple-touch-icon" sizes="180x180" href="pwa/apple-touch-icon-180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="pwa/apple-touch-icon-167.png">
    <link rel="apple-touch-icon" sizes="152x152" href="pwa/apple-touch-icon-152.png">
    <link rel="apple-touch-startup-image" href="pwa/splash-1242x2688.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3)">
    <link rel="apple-touch-startup-image" href="pwa/splash-1125x2436.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)">
    <link rel="apple-touch-startup-image" href="pwa/splash-1668x2388.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)">
    <link rel="apple-touch-startup-image" href="pwa/splash-2048x2732.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)">
</head>
<body>
    <a href="#landing-page" class="skip-link">Skip to content</a>
    <div id="app-auth-gate" class="auth-gate" aria-hidden="true">
        <div class="auth-gate-card">
            <div class="auth-brand">
                <img src="new-matla-logo.png" alt="Matla Life" class="menu-logo">
                <div>
                    <h2>Matla Access</h2>
                    <p id="authModeHint">Secure login before entering the dashboard. Use your own account details.</p>
                </div>
            </div>
            <div class="auth-mode-switch">
                <button id="authSignInBtn" class="action-btn" type="button" onclick="setAuthMode('signin')">Sign In</button>
                <button id="authAdminBtn" class="action-btn secondary" type="button" onclick="setAuthMode('admin')">Login as Admin</button>
                <button id="authCreateBtn" class="action-btn secondary" type="button" onclick="setAuthMode('signup')">Sign Up</button>
            </div>
            <p class="page-subtitle" id="authApprovalNote" style="display:none;">New users can register immediately. Admin gets notified automatically.</p>
            <form class="modal-form-grid" onsubmit="event.preventDefault(); submitAppAuth();">
                <div class="form-group">
                    <label for="authUsername">Username or Email</label>
                    <input type="text" id="authUsername" autocomplete="username email" placeholder="e.g. nkulu@matla.co.za">
                </div>
                <div class="form-group" id="authEmailGroup" style="display:none;">
                    <label for="authEmail">Email Address</label>
                    <input type="email" id="authEmail" autocomplete="email" placeholder="e.g. nkulu@matla.co.za">
                </div>
                <div class="form-group">
                    <label for="authPassword">Password</label>
                    <input type="password" id="authPassword" autocomplete="current-password" placeholder="Enter password">
                    <div id="authPasswordStrength" class="password-strength" aria-live="polite"></div>
                </div>
                <div class="form-group">
                    <button class="action-btn secondary auth-toggle-password" type="button" id="authShowPasswordBtn" aria-pressed="false">Show Password</button>
                </div>
                <div class="auth-remember-row">
                    <label class="auth-remember-label" for="authRememberMe">
                        <input type="checkbox" id="authRememberMe">
                        <span>Remember me</span>
                    </label>
                </div>
                <button class="link-btn" type="button" onclick="openForgotPasswordModal()">Forgot password?</button>
                <div class="form-group" id="authConfirmGroup" style="display:none;">
                    <label for="authConfirmPassword">Confirm Password</label>
                    <input type="password" id="authConfirmPassword" autocomplete="new-password" placeholder="Confirm password">
                </div>
                <div class="form-group" id="authTermsGroup" style="display:none;">
                    <label class="radio-option">
                        <input type="checkbox" id="authTermsCheck">
                        <span class="radio-label">I agree to handle client data confidentially and follow company policy. <button class="link-btn" type="button" onclick="openPolicyModal()">View policy</button></span>
                    </label>
                </div>
                <div id="authCapsWarning" class="modal-error" style="display:none;">Caps Lock is on.</div>
                <div id="appAuthError" class="modal-error" style="display:none;" aria-live="polite"></div>
                <div class="modal-actions">
                    <button id="authSubmitBtn" class="action-btn" type="submit">Enter Dashboard</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <button class="logo-button" type="button" onclick="toggleSidebar()">
                <span class="logo-button-oval compact">
                    <span class="menu-icon" aria-hidden="true">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                    <img src="matla-life-logo2.png" alt="Matla Life" class="nav-logo">
                </span>
            </button>
            <div class="nav-info">
                <span>Mon - Fri 8:00-17:30</span>
                <span>+27 (0) 10 065 2659</span>
            </div>
            <div class="nav-actions">
                <span id="appUserBadge" class="status-pill" style="display:none;">User: â€”</span>
                <span id="offlineStatus" class="status-pill" data-last-saved="--:--" aria-live="polite">Offline Ready</span>
                <button class="action-btn secondary mobile-move-to-menu" id="switchUserBtn" type="button" onclick="logoutAppUser()" style="display:none;">Switch User</button>
                <button class="action-btn secondary theme-toggle mobile-move-to-menu" type="button" onclick="toggleTheme()">Toggle Theme</button>
                <button class="nav-notification-btn" id="heroNotificationBtn" type="button" onclick="openNotificationModal()" aria-label="View notifications">
                    <span class="hero-notification-icon" aria-hidden="true">ðŸ””</span>
                    <span class="hero-notification-badge" id="heroNotificationBadge" aria-hidden="true"></span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Flow Stepper -->
    <div class="flow-stepper" aria-label="JFA Flow">
        <div class="flow-step" data-step="1">
            <span class="step-index">1</span>
            <span class="step-label">Intro</span>
        </div>
        <div class="flow-step" data-step="2">
            <span class="step-index">2</span>
            <span class="step-label">Register</span>
        </div>
        <div class="flow-step" data-step="3">
            <span class="step-index">3</span>
            <span class="step-label">Assignment</span>
        </div>
        <div class="flow-step" data-step="4">
            <span class="step-index">4</span>
            <span class="step-label">DBD</span>
        </div>
        <div class="flow-step" data-step="5">
            <span class="step-index">5</span>
            <span class="step-label">Dashboard</span>
        </div>
    </div>

    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar(true)"></div>
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h3>Menu</h3>
            <div class="menu-header-actions">
                <button class="action-btn secondary" type="button" onclick="openGlobalSearch()">Search</button>
                <button class="action-btn secondary" type="button" onclick="toggleSidebar(true)">Close</button>
            </div>
        </div>
        <div class="sidebar-section">
            <button class="sidebar-toggle" data-menu="admin" type="button" onclick="openMenuPage('admin')" title="Alt+1">
                <span>Admin</span>
                <span class="shortcut-pill">Alt+1</span>
            </button>
        </div>
        <div class="sidebar-section">
            <button class="sidebar-toggle" data-menu="learning" type="button" onclick="openMenuPage('learning')" title="Alt+2">
                <span>Learning Hub</span>
                <span class="shortcut-pill">Alt+2</span>
            </button>
        </div>
        <div class="sidebar-section">
            <button class="sidebar-toggle" data-menu="forms" type="button" onclick="openMenuPage('forms')" title="Alt+3">
                <span>Forms</span>
                <span class="shortcut-pill">Alt+3</span>
            </button>
        </div>
        <div class="sidebar-section">
            <button class="sidebar-toggle" data-menu="leads" type="button" onclick="toggleLeadsMenu()" title="Alt+4">
                <span>Leads</span>
                <span class="shortcut-pill">Alt+4</span>
            </button>
            <div class="sidebar-content" id="leadsSubmenu">
                <button class="sidebar-sub-btn" type="button" onclick="openLeadsFromMenu('submit')">Submit a Lead</button>
                <button class="sidebar-sub-btn" type="button" onclick="openLeadsFromMenu('view')">View My Leads</button>
            </div>
        </div>
        <div class="sidebar-section">
            <button class="sidebar-toggle" data-menu="appointments" type="button" onclick="openMenuPage('appointments')" title="Alt+5">
                <span>Appointments</span>
                <span class="shortcut-pill">Alt+5</span>
            </button>
        </div>
        <div class="sidebar-section">
            <button class="sidebar-toggle" data-menu="payments" type="button" onclick="openMenuPage('payments')" title="Alt+6">
                <span>Payments (Alignments)</span>
                <span class="shortcut-pill">Alt+6</span>
            </button>
        </div>
        <div class="sidebar-section">
            <button class="sidebar-toggle" data-menu="benSystem" type="button" onclick="openMenuPage('benSystem')" title="Alt+7">
                <span>Ben System</span>
                <span class="shortcut-pill">Alt+7</span>
            </button>
        </div>
        <div class="sidebar-footer">
            <button class="sidebar-settings-btn" id="adminHomeBtn" type="button" onclick="navigateAdminHome()" style="display:none;">
                <span>Admin Home</span>
            </button>
            <button class="sidebar-settings-btn" id="sidebarSettingsBtn" data-menu="settings" type="button" onclick="openMenuPage('settings')">
                <span class="gear-icon" aria-hidden="true">âš™</span>
                <span>Settings</span>
            </button>
            <button class="sidebar-signout-btn" type="button" onclick="confirmSidebarSignOut()">
                <span>Sign Out</span>
            </button>
            <button class="sidebar-settings-btn mobile-only-menu-control" type="button" onclick="logoutAppUser()">
                <span>Switch User</span>
            </button>
            <button class="sidebar-settings-btn mobile-only-menu-control" type="button" onclick="toggleTheme()">
                <span>Toggle Theme</span>
            </button>
        </div>
    </aside>

    <div class="menu-page-overlay" id="menuPageOverlay" onclick="closeMenuPage()"></div>

    <section class="menu-page" id="adminPage" aria-hidden="true">
        <div class="menu-page-inner">
            <div class="menu-page-header">
                <h2>Admin</h2>
                <span class="menu-scope-chip" id="adminScopeChip">Scope: Personal</span>
                <div class="menu-header-actions">
                    <button class="action-btn secondary" type="button" onclick="goBackMenuPage()">Back</button>
                    <button class="action-btn secondary" type="button" onclick="closeMenuPage()" title="Alt+0">Close</button>
                </div>
            </div>
            <div class="menu-illustration admin-illustration" aria-hidden="true">
                <div class="menu-illustration-text">With great Matla comes great responsibility.</div>
                <img src="new-matla-logo.png" alt="Matla Life" class="menu-logo">
            </div>
            <p class="menu-page-note team-portal-center-note">Team Portal Center: select a team to view scoped performance, attendance, DBD feedback, and compliance.</p>
            <div class="menu-page-actions" id="adminTeamPortalButtons"></div>
            <div class="admin-detail-section admin-inline-auth" id="teamInlineGate" style="display:none;">
                <div class="modal-card admin-all-access-card">
                    <div class="admin-auth-brand">
                        <img src="new-matla-logo.png" alt="Matla Life" class="menu-logo">
                        <div>
                            <h3 id="teamInlineTitle">Team Portal Access</h3>
                        </div>
                    </div>
                    <form class="modal-form-grid" onsubmit="event.preventDefault(); submitTeamPortalAccessInline();">
                        <div class="form-group">
                            <label for="teamInlineUsername">Username or Email</label>
                            <input type="text" id="teamInlineUsername" autocomplete="username email" placeholder="Enter username or email">
                        </div>
                        <div class="form-group">
                            <label for="teamInlinePassword">Password</label>
                            <input type="password" id="teamInlinePassword" autocomplete="current-password" placeholder="Enter password">
                        </div>
                        <div id="teamInlineError" class="modal-error" style="display:none;"></div>
                        <div class="modal-actions">
                            <button class="action-btn secondary" type="button" onclick="closeTeamAuthInline()">Cancel</button>
                            <button class="action-btn" type="submit">Enter Team Portal</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="menu-page-actions">
                <button class="action-btn secondary" type="button" onclick="openTeamArchives()">View Team Archives</button>
            </div>
            <div class="menu-page-scope" id="adminScopeNote">Scope: Personal</div>
            <div class="admin-insights" id="adminInsights"></div>
            <div class="admin-detail-section" id="adminTeamDetail"></div>
            <div class="admin-jfa-list" id="adminJfaList"></div>
            <div class="admin-detail-section" id="adminJfaInlineDetail"></div>
        </div>
    </section>

    <section class="menu-page" id="learningPage" aria-hidden="true">
        <div class="menu-page-inner">
            <div class="menu-page-header">
                <h2>Learning Hub</h2>
                <span class="menu-scope-chip" id="learningScopeChip">Learning Hub</span>
                <div class="menu-header-actions">
                    <button class="action-btn secondary" type="button" onclick="goBackMenuPage()">Back</button>
                </div>
            </div>
            <div class="menu-illustration learning-illustration" aria-hidden="true">
                <div class="menu-illustration-text">With great Matla comes great responsibility.</div>
                <img src="new-matla-logo.png" alt="Matla Life" class="menu-logo">
            </div>
            <div class="menu-page-actions">
                <button class="action-btn secondary" id="learningResumeBtn" type="button" onclick="resumeLearning()" style="display:none;">Resume Last Topic</button>
                <button class="action-btn secondary" id="learningBookmarkBtn" type="button" onclick="saveLearningBookmark()" style="display:none;">Bookmark Lesson</button>
                <button class="action-btn secondary" id="learningOpenBookmarkBtn" type="button" onclick="openLearningBookmark()" style="display:none;">Open Bookmark</button>
            </div>
            <div class="learning-search">
                <input type="text" id="learningSearchInput" placeholder="Search topics, concepts, or keywords...">
                <button class="action-btn secondary" type="button" onclick="applyLearningSearch()">Search</button>
                <button class="action-btn secondary" type="button" onclick="clearLearningSearch()">Clear</button>
            </div>
            <div class="learning-search-results" id="learningSearchResults"></div>
            <div class="menu-page-actions">
                <button class="action-btn secondary" type="button" onclick="showLearning('jfaManual')">JFA Manual (Day 1)</button>
                <button class="action-btn secondary" type="button" onclick="showLearning('marketing')">Marketing System</button>
                <button class="action-btn secondary" type="button" onclick="showLearning('loa')">L.O.A. (Law of Average)</button>
                <button class="action-btn secondary" type="button" onclick="showLearning('five')">5 Steps</button>
                <button class="action-btn secondary" type="button" onclick="showLearning('eight')">8 Steps</button>
                <button class="action-btn secondary" type="button" onclick="showLearning('fugi')">FUGI Factors</button>
                <button class="action-btn secondary" type="button" onclick="showLearning('impulse')">Impulse Factors</button>
                <button class="action-btn secondary" type="button" onclick="showLearning('cod')">C.O.D. (Cycle Of Development)</button>
                <button class="action-btn secondary" type="button" onclick="showLearning('cross')">Cross Selling</button>
            </div>
            <div class="learning-body menu-page-body" id="learningBody"></div>

            <div class="menu-page-subsection">
                <h3>Product Knowledge</h3>
                <div class="menu-page-actions">
                    <button class="action-btn secondary" type="button" onclick="showLearning('consolidation')">Consolidation</button>
                    <button class="action-btn secondary" type="button" onclick="showLearning('life')">Life Cover</button>
                    <button class="action-btn secondary" type="button" onclick="showLearning('capital')">Capital Legacy</button>
                    <button class="action-btn secondary" type="button" onclick="showLearning('matla')">Matla Plan</button>
                </div>
                <div class="learning-body menu-page-body" id="productBody"></div>
            </div>
        </div>
    </section>

    <section class="menu-page" id="formsPage" aria-hidden="true">
        <div class="menu-page-inner">
            <div class="menu-page-header">
                <h2>Forms</h2>
                <span class="menu-scope-chip" id="formsScopeChip">Downloads</span>
                <div class="menu-header-actions">
                    <button class="action-btn secondary" type="button" onclick="goBackMenuPage()">Back</button>
                    <button class="action-btn secondary" type="button" onclick="closeMenuPage()" title="Alt+0">Close</button>
                </div>
            </div>
            <div class="menu-illustration forms-illustration" aria-hidden="true">
                <div class="menu-illustration-text">With great Matla comes great responsibility.</div>
                <img src="new-matla-logo.png" alt="Matla Life" class="menu-logo">
            </div>
            <p class="menu-page-note">Download the official forms below. Master Logger can update this list.</p>
            <div class="form-list" id="formsList"></div>
        </div>
    </section>

    <section class="menu-page" id="leadsPage" aria-hidden="true">
        <div class="menu-page-inner">
            <div class="menu-page-header">
                <h2>Leads</h2>
                <span class="menu-scope-chip" id="leadsScopeChip">Lead Center</span>
                <div class="menu-header-actions">
                    <button class="action-btn secondary" type="button" onclick="goBackMenuPage()">Back</button>
                    <button class="action-btn secondary" type="button" onclick="closeMenuPage()" title="Alt+0">Close</button>
                </div>
            </div>
            <div class="menu-illustration forms-illustration" aria-hidden="true">
                <div class="menu-illustration-text">With great Matla comes great responsibility.</div>
                <img src="new-matla-logo.png" alt="Matla Life" class="menu-logo">
            </div>
            <p class="menu-page-note">Capture Broker Authority leads digitally and track your own totals securely.</p>
            <div class="menu-page-actions">
                <button class="action-btn secondary" type="button" id="leadSubmitTabBtn" onclick="openLeadsTab('submit')">Submit a Lead</button>
                <button class="action-btn secondary" type="button" id="leadViewTabBtn" onclick="openLeadsTab('view')">View My Leads</button>
            </div>

            <div id="leadSubmitPanel" class="lead-panel">
                <div class="lead-panel-head">
                    <h3>Broker Authority Lead Form</h3>
                    <p class="page-subtitle">Client captures details manually on-site.</p>
                    <div id="leadBrokerAuthorityCode" class="lead-authority-code">Broker Authority Code: BA-2026-MLI</div>
                </div>
                <div id="leadDraftNotice" class="lead-draft-notice" style="display:none;"></div>
                <form id="leadForm" class="lead-form-grid">
                    <div class="lead-section">
                        <div class="lead-section-title">Client Details</div>
                        <div class="form-group">
                            <label for="leadClientName">Client's Full Names *</label>
                            <input type="text" id="leadClientName" required placeholder="Enter full names">
                        </div>
                        <div class="form-group">
                            <label for="leadClientId">Identity Number *</label>
                            <input type="text" id="leadClientId" required placeholder="Enter ID or passport number">
                        </div>
                        <div class="form-group">
                            <label for="leadClientPersal">Persal No.</label>
                            <input type="text" id="leadClientPersal" placeholder="Enter Persal number">
                        </div>
                        <div class="form-group">
                            <label for="leadClientAddress">Physical Address *</label>
                            <textarea id="leadClientAddress" rows="3" required placeholder="Enter physical address"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="leadClientCell">Contact Details (C) *</label>
                            <input type="tel" id="leadClientCell" required placeholder="Cell number" inputmode="tel">
                        </div>
                        <div class="form-group">
                            <label for="leadClientHome">Contact Details (H)</label>
                            <input type="tel" id="leadClientHome" placeholder="Home number" inputmode="tel">
                        </div>
                        <div class="form-group">
                            <label for="leadClientEmail">E-Mail Address</label>
                            <input type="email" id="leadClientEmail" placeholder="email@example.com" inputmode="email">
                        </div>
                    </div>

                    <div class="lead-section">
                        <div class="lead-section-title">Acknowledgement</div>
                        <div class="lead-tc-box">
                            <p><strong>I acknowledge the following:</strong></p>
                            <p>Appropriate financial advice can only be furnished after full and proper disclosure of relevant personal and private information about the client.</p>
                            <p>Such information is furthermore required to either:</p>
                            <ul>
                                <li>Determine my financial situation, financial product experience and financial needs and objectives</li>
                                <li>Acquire, maintain and service any financial product or to render related intermediary services</li>
                            </ul>
                            <p>Such information may include any information relating to, or interest in:</p>
                            <ul>
                                <li>Long term insurance</li>
                                <li>Or any other financial product or service</li>
                            </ul>
                            <p>My interest will be best served for the stated purpose if any and all such information is provided by:</p>
                            <ul>
                                <li>The financial services exchange (Pty) Ltd, trading as Astute, or any other institution providing a mechanism for the transmission of such information, or</li>
                                <li>Any other authorized financial services provider</li>
                            </ul>
                        </div>
                    </div>

                    <div class="lead-section">
                        <div class="lead-section-title">Authorized User Consent</div>
                        <p class="page-subtitle">I/we herewith give consent to any such authorized financial services provider to release such information through Astute or directly, to the authorized user(s) below:</p>
                        <div class="form-group">
                            <label for="leadAuthorizedUser">Authorized User</label>
                            <input type="text" id="leadAuthorizedUser" placeholder="Authorized user name">
                        </div>
                        <div class="form-group">
                            <label for="leadAuthorizedId">ID No.</label>
                            <input type="text" id="leadAuthorizedId" placeholder="Authorized user ID">
                        </div>
                        <div class="form-group">
                            <label for="leadAuthorizedEmail">Email Address</label>
                            <input type="email" id="leadAuthorizedEmail" placeholder="Authorized user email">
                        </div>
                        <div class="form-group">
                            <label for="leadIntermediary">Intermediary</label>
                            <input type="text" id="leadIntermediary" value="Matla Life Investment" readonly>
                        </div>
                        <div class="lead-tc-box">
                            <p>I confirm that the authorized user(s) will be acting on my behalf and I hereby waive any right to privacy only for the stated purpose. All information obtained must be treated as confidential by the authorized user(s) and intermediary and may not be made public in anyway without my written consent.</p>
                            <p>This consent to obtain information will remain effective for 12 months or until cancelled by me in writing.</p>
                        </div>
                        <label class="radio-option">
                            <input type="checkbox" id="leadWill">
                            <span class="radio-label">
                                <strong>I am interested in drafting my LAST WILL AND TESTIMONY</strong>
                            </span>
                        </label>
                    </div>

                    <div class="lead-section">
                        <div class="lead-section-title">Products With</div>
                        <p class="page-subtitle">I/we have products with:</p>
                        <div class="lead-policy-table">
                            <div class="lead-policy-row">
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="ABSA"> ABSA</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="AVBOB"> AVBOB</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Safrica"> Safrica</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Standard bank"> Standard bank</label>
                            </div>
                            <div class="lead-policy-row">
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Assupol"> Assupol</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Metropolitan"> Metropolitan</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Old mutual group"> Old mutual group</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Capitec"> Capitec</label>
                            </div>
                            <div class="lead-policy-row">
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Old Mutual"> Old Mutual</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Liberty Life"> Liberty Life</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Sanlam sky"> Sanlam sky</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Nedbank"> Nedbank</label>
                            </div>
                            <div class="lead-policy-row">
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Sanlam"> Sanlam</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Discovery Life"> Discovery Life</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Regent"> Regent</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="FNB"> FNB</label>
                            </div>
                            <div class="lead-policy-row">
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Workers Life"> Workers Life</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Channel Life"> Channel Life</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Clientele Life"> Clientele Life</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Momentum"> Momentum</label>
                            </div>
                            <div class="lead-policy-row">
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Lion of Africa"> Lion of Africa</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Hollard"> Hollard</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="1Life Insurance"> 1Life Insurance</label>
                                <label class="lead-policy-item"><input type="checkbox" name="leadProducts" value="Other"> Other</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="leadOtherProduct">Other (please specify)</label>
                            <input type="text" id="leadOtherProduct" placeholder="Other product">
                        </div>
                    </div>

                    <div class="lead-section">
                        <div class="lead-section-title">Signature</div>
                        <div class="lead-signature-grid">
                            <div class="form-group">
                                <label for="leadSignedAt">Signed at</label>
                                <input type="text" id="leadSignedAt" placeholder="Location">
                            </div>
                            <div class="form-group">
                                <label for="leadSignedDate">On the day of</label>
                                <input type="date" id="leadSignedDate">
                            </div>
                            <div class="form-group">
                                <label for="leadClientSignature">Client Full Name (Printed) *</label>
                                <input type="text" id="leadClientSignature" required placeholder="Type client full name">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="leadSignaturePad">Client Signature Pad *</label>
                            <div class="lead-signature-pad-wrap">
                                <canvas id="leadSignaturePad" class="lead-signature-pad" width="900" height="240" aria-label="Client signature drawing pad"></canvas>
                            </div>
                            <div class="menu-page-actions" style="margin-top:8px;">
                                <button class="action-btn secondary" type="button" onclick="undoLeadSignatureStroke()">Undo Last Stroke</button>
                                <button class="action-btn secondary" type="button" onclick="clearLeadSignaturePad()">Clear Signature</button>
                            </div>
                            <input type="hidden" id="leadSignatureData">
                            <p class="page-subtitle" id="leadSignatureHint">Use finger, mouse, or trackpad to sign.</p>
                        </div>
                    </div>

                    <div class="lead-section">
                        <div class="lead-section-title">Lead Notes</div>
                        <div class="form-group">
                            <label for="leadNotes">Notes</label>
                            <textarea id="leadNotes" rows="3" placeholder="Optional context and follow-up notes..."></textarea>
                        </div>
                        <div class="lead-section-title" style="margin-top:10px;">Appointment (Optional)</div>
                        <p class="page-subtitle">Set quotation appointment now, or add it later in Appointments.</p>
                        <div class="lead-signature-grid">
                            <div class="form-group">
                                <label for="leadAppointmentDate">Appointment Date</label>
                                <input type="date" id="leadAppointmentDate">
                            </div>
                            <div class="form-group">
                                <label for="leadAppointmentTime">Appointment Time</label>
                                <input type="time" id="leadAppointmentTime">
                            </div>
                        </div>
                    </div>

                    <label class="radio-option lead-consent-check">
                        <input type="checkbox" id="leadClientConsent" required>
                        <span class="radio-label">
                            <strong>Client Consent Confirmed</strong>
                            <small>I confirm the client completed this form manually and consented to the terms above.</small>
                        </span>
                    </label>
                    <p class="page-subtitle">Location is captured for admin verification only.</p>
                    <p class="page-subtitle">Matlalife.co.za</p>
                    <div class="menu-page-actions">
                        <button class="action-btn" type="submit">Submit Lead</button>
                        <button class="action-btn secondary" type="button" onclick="clearLeadDraft(true)">Clear Form</button>
                    </div>
                </form>
            </div>

            <div id="leadViewPanel" class="lead-panel" style="display:none;">
                <div class="lead-panel-head">
                    <h3>My Lead Totals</h3>
                    <p class="page-subtitle">Privacy mode: client personal information is hidden.</p>
                </div>
                <div class="menu-page-actions">
                    <button class="action-btn secondary" type="button" onclick="exportMyLeadsSummaryCsv()">Download My Lead Summary</button>
                    <button class="action-btn secondary" type="button" onclick="adjustMyConsentFormsToday()">Adjust My Consent Forms (Today)</button>
                </div>
                <div id="leadViewSummary" class="summary-grid"></div>
                <div id="leadViewBreakdown" class="mini-table"></div>
            </div>
        </div>
    </section>

    <section class="menu-page" id="appointmentsPage" aria-hidden="true">
        <div class="menu-page-inner">
            <div class="menu-page-header">
                <h2>Appointments</h2>
                <span class="menu-scope-chip" id="appointmentsScopeChip">Quotation Scheduling</span>
                <div class="menu-header-actions">
                    <button class="action-btn secondary" type="button" onclick="goBackMenuPage()">Back</button>
                    <button class="action-btn secondary" type="button" onclick="closeMenuPage()" title="Alt+0">Close</button>
                </div>
            </div>
            <div class="menu-page-note">Set or manage client quotation appointments using lead-linked LIDs.</div>
            <div class="admin-detail-section" id="appointmentsBody"></div>
        </div>
    </section>

    <section class="menu-page" id="paymentsPage" aria-hidden="true">
        <div class="menu-page-inner">
            <div class="menu-page-header">
                <h2>Payments</h2>
                <span class="menu-scope-chip" id="paymentsScopeChip">Leads Outcome</span>
                <div class="menu-header-actions">
                    <button class="action-btn secondary" type="button" onclick="goBackMenuPage()">Back</button>
                    <button class="action-btn secondary" type="button" onclick="closeMenuPage()" title="Alt+0">Close</button>
                </div>
            </div>
            <div class="menu-page-actions payments-tabs">
                <button class="action-btn secondary" type="button" data-payments-tab="pending" onclick="setPaymentsTab('pending')">Pending</button>
                <button class="action-btn secondary" type="button" data-payments-tab="unsuccessful" onclick="setPaymentsTab('unsuccessful')">Unsuccessful</button>
                <button class="action-btn secondary" type="button" data-payments-tab="successful" onclick="setPaymentsTab('successful')">Successful</button>
            </div>
            <div class="learning-search" style="margin-top:10px;">
                <input type="text" id="paymentsSearchInput" placeholder="Search by LID or client name...">
            </div>
            <div class="menu-page-actions" style="margin-top:8px;">
                <button class="action-btn secondary" type="button" onclick="clearPaymentsSearch()">Clear Search</button>
            </div>
            <div class="insight-list" id="paymentsSummary"></div>
            <div class="menu-page-body" id="paymentsBody"></div>
        </div>
    </section>

    <section class="menu-page" id="benSystemPage" aria-hidden="true">
        <div class="menu-page-inner">
            <div class="menu-page-header">
                <h2>Ben System</h2>
                <span class="menu-scope-chip" id="benSystemScopeChip">Facility Grouping</span>
                <div class="menu-header-actions">
                    <button class="action-btn secondary" type="button" onclick="goBackMenuPage()">Back</button>
                    <button class="action-btn secondary" type="button" onclick="closeMenuPage()" title="Alt+0">Close</button>
                </div>
            </div>
            <div class="menu-page-note ben-system-primary-note">Grouped daily view of facilities and all JFAs assigned to each one.</div>
            <div class="learning-search" style="margin-top:10px;">
                <input type="text" id="benSystemSearchInput" placeholder="Search facility, area, team or JFA...">
            </div>
            <div class="menu-page-actions" style="margin-top:8px;">
                <button class="action-btn secondary" type="button" onclick="clearBenSystemSearch()">Clear Search</button>
                <button class="action-btn secondary" type="button" onclick="exportBenSystemCsv()">Export CSV</button>
                <button class="action-btn secondary" type="button" onclick="exportBenSystemPdf()">Export PDF</button>
            </div>
            <div class="insight-list" id="benSystemSummary"></div>
            <div class="menu-page-body" id="benSystemBody"></div>
        </div>
    </section>

    <section class="menu-page" id="teamDetailPage" aria-hidden="true">
        <div class="menu-page-inner">
            <div class="menu-page-header">
                <h2 id="teamDetailTitle">Team Detail</h2>
                <span class="menu-scope-chip" id="teamScopeChip">Scope: Team</span>
                <div class="menu-header-actions">
                    <button class="action-btn secondary" type="button" onclick="openTeamLeaderSettings()">Settings</button>
                    <button class="action-btn secondary" id="teamSendNotificationBtn" type="button" style="display:none;">Send Notification</button>
                    <button class="action-btn secondary" type="button" onclick="goBackMenuPage()">Back</button>
                    <button class="action-btn secondary" type="button" onclick="closeMenuPage()" title="Alt+0">Close</button>
                </div>
            </div>
            <div class="menu-illustration admin-illustration" aria-hidden="true">
                <div class="menu-illustration-text">With great Matla comes great responsibility.</div>
                <img src="new-matla-logo.png" alt="Matla Life" class="menu-logo">
            </div>
            <div class="menu-page-scope" id="teamDetailScope">Scope: Team</div>
            <div class="admin-detail-section" id="teamDetailContent"></div>
            <div class="admin-detail-section" id="teamNotificationInline" style="display:none;"></div>
            <div class="admin-detail-section" id="teamDetailInlineDetail"></div>
        </div>
    </section>

    <section class="menu-page" id="archivedJfaPage" aria-hidden="true">
        <div class="menu-page-inner">
            <div class="menu-page-header">
                <h2>Archived JFAs</h2>
                <span class="menu-scope-chip" id="archivedScopeChip">Archive Vault</span>
                <div class="menu-header-actions">
                    <button class="action-btn secondary" type="button" onclick="goBackMenuPage()">Back</button>
                    <button class="action-btn secondary" type="button" onclick="closeMenuPage()" title="Alt+0">Close</button>
                </div>
            </div>
            <div class="menu-illustration admin-illustration" aria-hidden="true">
                <div class="menu-illustration-text">With great Matla comes great responsibility.</div>
                <img src="new-matla-logo.png" alt="Matla Life" class="menu-logo">
            </div>
            <div class="menu-page-note">Restore archived JFAs when they return.</div>
            <div class="learning-search">
                <input type="text" id="archivedJfaSearch" placeholder="Search archived JFAs...">
                <button class="action-btn secondary" type="button" onclick="filterArchivedJfas()">Search</button>
                <button class="action-btn secondary" type="button" onclick="clearArchivedSearch()">Clear</button>
            </div>
            <div class="admin-jfa-list" id="archivedJfaList"></div>
        </div>
    </section>

    <section class="menu-page" id="learningDetailPage" aria-hidden="true">
        <div class="menu-page-inner">
            <div class="menu-page-header">
                <h2 id="learningDetailTitle">Learning Hub</h2>
                <span class="menu-scope-chip" id="learningDetailScopeChip">Topic View</span>
                <div class="menu-header-actions">
                    <button class="action-btn secondary" type="button" onclick="goBackMenuPage()">Back</button>
                    <button class="action-btn secondary" type="button" onclick="closeMenuPage()" title="Alt+0">Close</button>
                </div>
            </div>
            <div class="menu-illustration learning-illustration" aria-hidden="true">
                <div class="menu-illustration-text">With great Matla comes great responsibility.</div>
                <img src="new-matla-logo.png" alt="Matla Life" class="menu-logo">
            </div>
            <div class="learning-detail-progress">
                <div class="learning-detail-bar">
                    <div class="learning-detail-fill" id="learningDetailFill"></div>
                </div>
                <span id="learningDetailProgressLabel">Progress: 0%</span>
            </div>
            <div id="learningDetailBody" class="learning-detail-body"></div>
        </div>
    </section>

    <section class="menu-page" id="settingsPage" aria-hidden="true">
        <div class="menu-page-inner">
            <div class="menu-page-header">
                <h2>Settings</h2>
                <span class="menu-scope-chip" id="settingsScopeChip">Account</span>
                <div class="menu-header-actions">
                    <button class="action-btn secondary" type="button" onclick="goBackMenuPage()">Back</button>
                    <button class="action-btn secondary" type="button" onclick="closeMenuPage()" title="Alt+0">Close</button>
                </div>
            </div>
            <div class="menu-illustration admin-illustration" aria-hidden="true">
                <div class="menu-illustration-text">Secure account controls and user setup.</div>
                <img src="new-matla-logo.png" alt="Matla Life" class="menu-logo">
            </div>
            <div id="settingsBody" class="admin-detail-section"></div>
        </div>
    </section>

    <button class="menu-fab" id="menuPageTopBtn" type="button" onclick="scrollMenuPageTop()">Back to Top</button>

    <div id="stickySummary" class="sticky-summary" aria-live="polite">
        <span class="sticky-label">Today</span>
        <span class="sticky-value" id="stickyTotalForms">0 forms</span>
        <span class="sticky-divider"></span>
        <span class="sticky-value" id="stickyProgress">0% target</span>
    </div>

    <!-- Page 1: Landing/Introduction -->
    <section id="landing-page" class="page active">
        <div class="onboarding-banner" id="onboardingBanner">
            <div>
                <h4>Quick Start</h4>
                <p>1) Register for today. 2) Submit DBD/Leads. 3) Track stats and payments in real time.</p>
            </div>
            <button class="action-btn secondary" type="button" onclick="dismissOnboarding()">Got it</button>
        </div>
        <div class="hero-section">
            <div class="hero-overlay"></div>
            <div class="hero-orb orb-one"></div>
            <div class="hero-orb orb-two"></div>
            <div class="hero-particles" aria-hidden="true"></div>
            <div class="hero-spotlight" aria-hidden="true"></div>
            <div class="hero-content">
                <div class="hero-headline hero-stage" id="heroHeadline">With great Matla comes great responsibility.</div>
                <div class="hero-subheadline hero-stage" id="heroSubheadline">Smarter field execution, measurable daily impact.</div>
                <img src="new-matla-logo.png" alt="Matla Life" class="hero-logo hero-stage">
                <div class="hero-ribbon hero-stage"></div>
                <div class="hero-glass hero-stage">
                    <p class="hero-tagline" id="heroTagline">With Great MATLA comes great responsibility.</p>
                    <div class="hero-status-ribbon" id="heroStatusRibbon">System: Offline Ready</div>
                    <div class="hero-status-strip" id="heroStatusStrip" aria-live="polite">
                        <span class="status-chip chip-ok" id="heroSessionState">Session: Locked</span>
                        <span class="status-chip chip-warn" id="heroSyncState">Sync: Offline</span>
                        <span class="status-chip chip-ok" id="heroAccessState">Access: User</span>
                    </div>
                    <div class="hero-actions">
                        <button class="jfa-register-btn hero-primary-cta" type="button" onclick="navigateToRegister()">
                            <span class="btn-text">Start Registration</span>
                            <span class="btn-icon">â†’</span>
                        </button>
                        <button class="action-btn secondary hero-secondary-cta" type="button" onclick="openMenuPage('leads')">Open Leads</button>
                        <button class="jfa-register-btn hero-primary-cta fa-hero-cta" type="button" onclick="openFaRegistrationPage()">
                            <span class="btn-text">FA Register</span>
                            <span class="btn-icon">â†’</span>
                        </button>
                    </div>
                    <div class="hero-badges">
                        <span class="badge">100% Black Owned</span>
                        <span class="badge">Level 1 BBBEE</span>
                    </div>
                    <div class="hero-top3">
                    <div class="hero-top-title">Top JFAs</div>
                        <div class="hero-top-list" id="heroTopList">
                            <span class="hero-top-item">â€”</span>
                        </div>
                    </div>
                    <div class="hero-mini">
                        <div class="hero-mini-item">
                            <span class="hero-mini-value" id="heroRegistrations">0</span>
                            <span class="hero-mini-label">Registrations Today</span>
                        </div>
                        <div class="hero-mini-item">
                            <span class="hero-mini-value" id="heroForms">0</span>
                            <span class="hero-mini-label">Consent Forms Today</span>
                        </div>
                    </div>
                    <div class="hero-progress">
                        <span class="hero-progress-label">Todayâ€™s Target Progress</span>
                        <div class="hero-progress-bar">
                            <div class="hero-progress-fill" id="heroTargetProgress"></div>
                        </div>
                        <span class="hero-progress-value" id="heroTargetValue">0% (0 / 2)</span>
                    </div>
                    <div class="hero-last">
                        Last submission: <span id="heroLastSubmission">â€”</span>
                    </div>
                    <div class="hero-assist" id="heroAssistHint">Last action: none yet. Next: Start Registration.</div>
                    <div class="hero-stats">
                        <div class="hero-stat">
                            <span class="hero-stat-value" id="heroDailyTargetStat">2</span>
                            <span class="hero-stat-label">Daily Target</span>
                        </div>
                        <div class="hero-stat">
                            <span class="hero-stat-value" id="heroWeeklyTargetStat">10</span>
                            <span class="hero-stat-label">Weekly Target</span>
                        </div>
                        <div class="hero-stat">
                            <span class="hero-stat-value" id="heroMonthlyTargetStat">40</span>
                            <span class="hero-stat-label">Monthly Target</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section-divider" data-label="About"></div>

        <div class="about-section">
            <div class="container">
                <div class="section-heading" data-icon="âœ¨">Introduction</div>
                <div class="summary-panel" aria-live="polite">
                    <div class="summary-card">
                        <div class="summary-title">Todayâ€™s Summary</div>
                        <div class="summary-grid">
                            <div class="summary-item">
                                <span class="summary-value" id="summaryRegistrations">0</span>
                                <span class="summary-label">Registrations</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-value" id="summaryForms">0</span>
                                <span class="summary-label">Consent Forms</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-value" id="summaryProductive">0%</span>
                                <span class="summary-label">Productive Rate</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="about-grid">
                    <div class="about-card">
                        <div class="icon" aria-hidden="true">
                            <svg viewBox="0 0 24 24" role="img">
                                <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="1.8"/>
                                <circle cx="12" cy="12" r="4" fill="none" stroke="currentColor" stroke-width="1.8"/>
                                <circle cx="12" cy="12" r="1.2" fill="currentColor"/>
                            </svg>
                        </div>
                        <h3>Who we are</h3>
                        <p>Matla Life is a sales and marketing solutions company, we engineer services relevant to our diverse partners. Ultimately, we offer innovative resolutions for African business problems.</p>
                    </div>
                    <div class="about-card">
                        <div class="icon" aria-hidden="true">
                            <svg viewBox="0 0 24 24" role="img">
                                <rect x="3" y="7" width="18" height="12" rx="2" fill="none" stroke="currentColor" stroke-width="1.8"/>
                                <path d="M8 7V5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" fill="none" stroke="currentColor" stroke-width="1.8"/>
                                <path d="M3 12h18" fill="none" stroke="currentColor" stroke-width="1.8"/>
                            </svg>
                        </div>
                        <h3>What we do</h3>
                        <p>We cater to the needs of our partners, by providing sales, marketing and analytical tactics, to ensure sales growth and market penetration.</p>
                    </div>
                    <div class="about-card">
                        <div class="icon" aria-hidden="true">
                            <svg viewBox="0 0 24 24" role="img">
                                <path d="M12 20s-7-4.5-9-8.5C1.5 8 3.5 5.5 6 5.5c1.7 0 3 1 4 2.3 1-1.3 2.3-2.3 4-2.3 2.5 0 4.5 2.5 3 6-2 4-9 8.5-9 8.5z" fill="none" stroke="currentColor" stroke-width="1.8"/>
                            </svg>
                        </div>
                        <h3>Why we do it</h3>
                        <p>We endeavor to add value to our partners by engineering a package fully reflective of their bottom line.</p>
                    </div>
                </div>

                <div class="section-divider" data-label="Services"></div>

                <div class="services-section">
                    <h2>Our Services</h2>
                    <div class="services-grid">
                        <div class="service-item">
                            <h4>Field Marketing</h4>
                            <p>Transforming the face-to-face channel through business-to-business interactions.</p>
                        </div>
                        <div class="service-item">
                            <h4>Contact Center</h4>
                            <p>Well-trained consultants skilled in converting leads into quality sales.</p>
                        </div>
                        <div class="service-item">
                            <h4>Financial Advisors</h4>
                            <p>Expert advisers certified to meet long-term insurance needs of customers.</p>
                        </div>
                        <div class="service-item">
                            <h4>Campaign Insights</h4>
                            <p>Pre & Post campaign insights resulting in successful business ingenuity.</p>
                        </div>
                    </div>
                </div>

                <div class="section-divider" data-label="Register"></div>

                <div class="cta-section">
                    <button class="jfa-register-btn" type="button" onclick="navigateToRegister()">
                        <span class="btn-text">JFA REGISTER</span>
                        <span class="btn-icon">â†’</span>
                    </button>
                    <div class="start-here">
                        <span>Start Here</span>
                        <span class="start-arrow">â†“</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="trust-strip">
        <span class="trust-item">Capital Legacy</span>
        <span class="trust-item">RMA</span>
        <span class="trust-item">Matla Plan</span>
        <span class="trust-item">Consolidation</span>
    </div>
    <button class="back-to-top" type="button" onclick="window.scrollTo({ top: 0, behavior: 'smooth' });">â†‘ Top</button>
    <footer class="site-footer">
        Matla Life Daily Ops â€¢ <span id="siteVersion">v1.0.62</span>
    </footer>

    <!-- Page 1B: FA Registration -->
    <section id="fa-registration-page" class="page">
        <div class="container">
            <div class="page-header">
                <button class="back-btn" type="button" onclick="resetToLanding()">â† Back to Home</button>
                <div class="section-heading" data-icon="ðŸ§¾">FA Register</div>
                <h1>Financial Advisor Attendance Register</h1>
                <p class="page-subtitle">Capture FA attendance details for today.</p>
            </div>
            <div class="registration-form-container">
                <form id="faRegisterForm">
                    <div class="master-capture-grid">
                        <div class="form-group">
                            <label for="faRegisterName">Name *</label>
                            <input type="text" id="faRegisterName" required placeholder="Enter first name" autocomplete="given-name">
                        </div>
                        <div class="form-group">
                            <label for="faRegisterSurname">Surname *</label>
                            <input type="text" id="faRegisterSurname" required placeholder="Enter surname" autocomplete="family-name">
                        </div>
                        <div class="form-group">
                            <label for="faRegisterMobile">Mobile Number *</label>
                            <input type="tel" id="faRegisterMobile" required placeholder="0XX XXX XXXX" autocomplete="tel" inputmode="tel">
                        </div>
                        <div class="form-group">
                            <label for="faRegisterEmail">Email Address *</label>
                            <input type="email" id="faRegisterEmail" required placeholder="name@company.com" autocomplete="email">
                        </div>
                        <div class="form-group">
                            <label for="faRegisterTeam">FA Team</label>
                            <select id="faRegisterTeam">
                                <option value="">No FA teams created yet</option>
                            </select>
                        </div>
                    </div>
                    <div class="menu-page-actions">
                        <button class="action-btn secondary" type="button" onclick="resetToLanding()">Cancel</button>
                        <button class="submit-btn" type="submit">Complete Register</button>
                    </div>
                    <p class="page-subtitle" id="faRegisterStatus" aria-live="polite" style="margin-top:10px;"></p>
                </form>
            </div>
        </div>
    </section>

    <!-- Page 2: JFA Registration -->
    <section id="registration-page" class="page">
        <div class="container">
            <div class="page-header">
                <button class="back-btn" type="button" onclick="resetToLanding()">â† Back to Home</button>
                <div class="section-heading" data-icon="ðŸ§¾">Registration</div>
                <h1>Junior Financial Advisor Registration</h1>
                <p class="page-subtitle">Register for today's facility allocation</p>
            </div>

            <div id="resumeBanner" class="resume-banner" style="display: none;">
                <div>
                    <strong>Continue your session?</strong>
                    <span id="resumeBannerText">You have an in-progress registration.</span>
                </div>
                <button class="action-btn" type="button" onclick="navigateToAssignment()">Continue</button>
            </div>

            <div class="registration-form-container">
                <form id="jfaForm">
                    <div class="form-group">
                        <label for="fullName">Name & Surname *</label>
                        <input type="text" id="fullName" required placeholder="Enter your full name" autocomplete="name">
                        <small class="input-hint">Use your full legal name and surname.</small>
                    </div>

                    <div class="form-group">
                        <label for="phoneNumber">Phone Number *</label>
                        <input type="tel" id="phoneNumber" required placeholder="0XX XXX XXXX" autocomplete="tel" inputmode="tel">
                        <small class="input-hint">Format: 0XX XXX XXXX</small>
                    </div>

                    <div class="form-group">
                        <label for="jfaTeam">JFA Team *</label>
                        <select id="jfaTeam" required>
                            <option value="">Select your team</option>
                            <option value="Team Thando">Team Thando</option>
                            <option value="Team Thato">Team Thato</option>
                            <option value="Team Rhulani">Team Rhulani</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Facility Preference *</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="facilityPlan" value="PLAN" required>
                                <span class="radio-label">
                                    <strong>I HAVE A PLAN</strong>
                                    <small>I know which facility I want to work at</small>
                                </span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="facilityPlan" value="NO PLAN" required>
                                <span class="radio-label">
                                    <strong>NO PLAN</strong>
                                    <small>Randomly assign me to a facility</small>
                                </span>
                            </label>
                        </div>
                    </div>

                    <div id="facilitySelection" class="form-group" style="display: none;">
                        <label for="selectedFacility">Select Facility *</label>
                        <div class="facility-legend">
                            <span class="legend-chip chip-ok">Available</span>
                            <span class="legend-chip chip-warn">Near Full</span>
                            <span class="legend-chip chip-danger">Full</span>
                            <span class="legend-chip chip-muted">Not Available Today</span>
                        </div>
                        <div class="facility-filter-row">
                            <input type="text" id="facilityFilter" placeholder="Filter facilities by name or area">
                            <button type="button" class="action-btn secondary" id="clearFacilityFilter">Clear</button>
                            <span class="filter-count" id="facilityFilterCount">0 shown</span>
                        </div>
                        <div class="facility-filter-row">
                            <label class="facility-checkbox">
                                <input type="checkbox" id="availableTodayOnly">
                                Show only todayâ€™s available facilities
                            </label>
                        </div>
                        <select id="selectedFacility">
                            <option value="">Choose a facility</option>
                            <option value="OTHER">Other (Type My Facility)</option>
                        </select>
                        <div class="available-today" id="availableTodayList"></div>
                        <div class="available-today-actions">
                            <button type="button" class="action-btn secondary" id="availableTodayMore">Show All Available</button>
                        </div>
                        <button type="button" class="action-btn secondary" id="showMoreFacilities">Show More</button>
                    </div>

                    <div id="autoAssignedFacility" class="form-group" style="display: none;">
                        <label>Auto-Assigned Facility</label>
                        <div class="auto-assign-card">
                            <span id="autoAssignedName">â€”</span>
                            <small id="autoAssignedArea"></small>
                        </div>
                    </div>

                    <div id="customFacilityFields" class="form-group" style="display: none;">
                        <label for="customFacilityName">Custom Facility Name *</label>
                        <input type="text" id="customFacilityName" placeholder="Enter facility name">
                        <label for="customFacilityType" style="margin-top: 12px;">Facility Type *</label>
                        <select id="customFacilityType">
                            <option value="">Select facility type</option>
                            <option value="Clinic">Clinic</option>
                            <option value="Hospital">Hospital</option>
                            <option value="School">School</option>
                            <option value="Police Station">Police Station</option>
                            <option value="Government">Government</option>
                            <option value="Prison">Prison</option>
                            <option value="Other">Other</option>
                        </select>
                        <label for="customFacilityContact" style="margin-top: 12px;">Contact Person *</label>
                        <input type="text" id="customFacilityContact" placeholder="Receptionist" value="Receptionist">
                        <label for="customFacilityArea" style="margin-top: 12px;">Facility Location/Area *</label>
                        <input type="text" id="customFacilityArea" placeholder="Enter location/area">
                        <label for="customFacilityPhone" style="margin-top: 12px;">Facility Contact Number *</label>
                        <input type="tel" id="customFacilityPhone" placeholder="0XX XXX XXXX" inputmode="tel">
                        <label for="customFacilityCapacity" style="margin-top: 12px;">Max JFAs (Optional)</label>
                        <input type="number" id="customFacilityCapacity" min="1" max="5" placeholder="Default 5">
                    </div>

                    <button type="submit" class="submit-btn">Complete Registration</button>
                </form>
            </div>
        </div>
    </section>

    <!-- Page 3: Facility Assignment -->
    <section id="assignment-page" class="page">
        <div class="container">
            <div class="assignment-reveal">
                <div class="reveal-header">
                    <button class="back-btn" type="button" onclick="navigateToRegister()">â† Back</button>
                    <button class="back-btn" type="button" onclick="navigateToRegister(true)">Edit Registration</button>
                    <div class="section-heading" data-icon="ðŸ§­">Assignment</div>
                    <h1>Your Assignment</h1>
                    <p class="date-display" id="assignmentDate"></p>
                </div>

                <div class="assignment-card">
                    <div class="assignment-badge">TODAY'S FACILITY</div>
                    <h2 id="assignedFacilityName" class="facility-reveal-name"></h2>
                    <div class="facility-details">
                        <div class="detail-item">
                            <span class="detail-label">Type:</span>
                            <span id="facilityTypeDisplay" class="detail-value"></span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Area:</span>
                            <span id="facilityAreaDisplay" class="detail-value"></span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Contact Person:</span>
                            <span id="facilityContactDisplay" class="detail-value"></span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Phone:</span>
                            <span id="facilityPhoneDisplay" class="detail-value"></span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Your Team:</span>
                            <span id="yourTeamDisplay" class="detail-value"></span>
                        </div>
                    </div>

                    <div class="assignment-actions">
                    <button class="action-btn" type="button" onclick="navigateToDBD()">Submit DBD â†’</button>
                    </div>
                    <div id="assignmentAppointmentReminders" class="insight-card" style="margin-top:14px;"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Page 4: DBD Submission -->
    <section id="dbd-page" class="page">
        <div class="container">
            <div class="page-header">
                <button class="back-btn" type="button" onclick="navigateToAssignment()">â† Back</button>
                <div class="section-heading" data-icon="ðŸ“‹">DBD</div>
                <h1>Daily Break Down (DBD)</h1>
                <p class="page-subtitle">Report your facility visit results</p>
            </div>

            <div class="dbd-form-container">
                <div class="current-facility-info">
                    <h3>Facility Visited:</h3>
                    <p id="dbdFacilityName" class="highlight-text"></p>
                </div>

                <form id="dbdForm">
                    <div class="form-group">
                        <label>Was this facility productive? *</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="productive" value="YES" required>
                                <span class="radio-label">
                                    <strong>âœ“ YES - Productive</strong>
                                    <small>Positive outcome, good engagement</small>
                                </span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="productive" value="NO" required>
                                <span class="radio-label">
                                    <strong>âœ— NO - Not Productive</strong>
                                    <small>Challenges encountered, limited success</small>
                                </span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="consentForms">Physical Paper Consent Forms Obtained *</label>
                        <input type="number" id="consentForms" min="0" required placeholder="Enter physical paper forms only (0 if none)" inputmode="numeric">
                        <small class="page-subtitle" id="consentAutoHint">Digital leads auto-added by system: 0. Physical: 0. Total consent forms: 0.</small>
                    </div>

                    <div class="form-group">
                        <label for="notes">Additional Notes (Optional)</label>
                        <textarea id="notes" rows="4" placeholder="Any observations or challenges..."></textarea>
                    </div>

                    <button type="submit" class="submit-btn">Submit DBD</button>
                    <button type="button" class="action-btn secondary" onclick="saveDbdDraft()">Save Draft</button>
                    <button type="button" class="action-btn" onclick="downloadCurrentDbd()">Download DBD</button>
                    <button type="button" class="action-btn secondary" onclick="editLastDbd()">Edit Last DBD</button>
                </form>
            </div>
        </div>
    </section>

    <!-- Page 5: Statistics Dashboard -->
    <section id="stats-page" class="page">
        <div class="container">
            <div class="page-header">
                <button class="back-btn" type="button" onclick="navigateToDBD()">â† Back</button>
                <div class="section-heading" data-icon="ðŸ“Š">Dashboard</div>
                <h1>Performance Dashboard</h1>
                <p class="page-subtitle">Real-time JFA Performance Statistics</p>
                <p class="page-subtitle">Last updated: <span id="statsLastUpdated">â€”</span></p>
                <div class="stats-controls">
                    <div class="toggle-row">
                        <label class="switch">
                            <input type="checkbox" id="sessionLockToggle">
                            <span class="slider"></span>
                        </label>
                        <span>Lock session after DBD</span>
                    </div>
                    <div class="stats-search">
                        <input type="text" id="jfaSearch" placeholder="Search JFA name...">
                    </div>
                    <div class="range-export">
                        <select id="exportRange">
                            <option value="today">Export Today</option>
                            <option value="this-week">Export This Week</option>
                            <option value="last-week">Export Last Week</option>
                            <option value="this-month">Export This Month</option>
                            <option value="custom">Custom Range</option>
                        </select>
                        <input type="date" id="exportStart">
                        <input type="date" id="exportEnd">
                        <button class="action-btn" type="button" onclick="exportRangeCsv()">Export Range</button>
                    </div>
                    <div class="stats-export">
                        <button class="action-btn secondary" type="button" onclick="exportTeamCsv('Team Thando')">Export Team Thando</button>
                        <button class="action-btn secondary" type="button" onclick="exportTeamCsv('Team Thato')">Export Team Thato</button>
                        <button class="action-btn secondary" type="button" onclick="exportTeamCsv('Team Rhulani')">Export Team Rhulani</button>
                    </div>
                </div>
                <div class="reset-time-control">
                    <label for="resetTime">Daily Reset Time</label>
                    <input type="time" id="resetTime">
                    <button type="button" class="action-btn secondary" onclick="saveResetTime()">Save</button>
                </div>
            </div>

            <div class="stats-dashboard">
                <!-- Targets & Leaders -->
                <div class="stats-section">
                    <h2 class="section-heading" data-icon="ðŸŽ¯">Targets & Leaders</h2>
                    <div class="targets-grid">
                        <div class="target-card">
                            <div class="target-title">Daily Target</div>
                            <div class="target-value" id="dailyTargetProgress">0 / 2</div>
                            <div class="target-bar">
                                <div class="target-bar-fill" id="dailyTargetBar"></div>
                            </div>
                            <div class="target-hint" id="dailyTargetHint">0% complete</div>
                            <div class="target-note" id="dailyTargetCarryoverNote"></div>
                            <div class="target-sub">Best JFA: <span id="dailyBestJfa">-</span></div>
                            <div class="target-sub">Best Team: <span id="dailyBestTeam">-</span></div>
                        </div>
                        <div class="target-card">
                            <div class="target-title">Weekly Target</div>
                            <div class="target-value" id="weeklyTargetProgress">0 / 10</div>
                            <div class="target-bar">
                                <div class="target-bar-fill" id="weeklyTargetBar"></div>
                            </div>
                            <div class="target-hint" id="weeklyTargetHint">0% complete</div>
                            <div class="target-sub">Best JFA: <span id="weeklyBestJfa">-</span></div>
                            <div class="target-sub">Best Team: <span id="weeklyBestTeam">-</span></div>
                        </div>
                        <div class="target-card">
                            <div class="target-title">Monthly Target</div>
                            <div class="target-value" id="monthlyTargetProgress">0 / 40</div>
                            <div class="target-bar">
                                <div class="target-bar-fill" id="monthlyTargetBar"></div>
                            </div>
                            <div class="target-hint" id="monthlyTargetHint">0% complete</div>
                            <div class="target-sub">Best JFA: <span id="monthlyBestJfa">-</span></div>
                            <div class="target-sub">Best Team: <span id="monthlyBestTeam">-</span></div>
                        </div>
                    </div>
                    <div class="target-tooltips">
                        <span class="tooltip">Daily target: each JFA should get 2 consent forms per day.</span>
                        <span class="tooltip">Weekly target: each JFA should get 10 consent forms per week.</span>
                        <span class="tooltip">Monthly target: each JFA should get 40 consent forms per month.</span>
                    </div>
                </div>

                <!-- Period Leaderboards -->
                <div class="stats-section">
                    <h2 class="section-heading" data-icon="ðŸ†">Leaderboards</h2>
                    <div class="top-badges">
                        <div class="top-team-badge">
                            Top Team of the Month: <span id="topTeamOfMonth">â€”</span>
                        </div>
                        <div class="top-team-badge">
                            Top JFA of the Month: <span id="topJfaOfMonth">â€”</span>
                        </div>
                    </div>
                    <div class="leaderboard-block">
                        <div class="leaderboard-title">JFAs</div>
                        <div class="targets-grid">
                            <div class="target-card">
                                <div class="target-title">Today</div>
                                <div id="dailyLeaderTable" class="mini-table"></div>
                            </div>
                            <div class="target-card">
                                <div class="target-title">This Week</div>
                                <div id="weeklyLeaderTable" class="mini-table"></div>
                            </div>
                            <div class="target-card">
                                <div class="target-title">This Month</div>
                                <div id="monthlyLeaderTable" class="mini-table"></div>
                            </div>
                        </div>
                    </div>
                    <div class="leaderboard-block">
                        <div class="leaderboard-title">Teams</div>
                        <div class="targets-grid">
                            <div class="target-card">
                                <div class="target-title">Today</div>
                                <div id="dailyTeamLeaderTable" class="mini-table"></div>
                            </div>
                            <div class="target-card">
                                <div class="target-title">This Week</div>
                                <div id="weeklyTeamLeaderTable" class="mini-table"></div>
                            </div>
                            <div class="target-card">
                                <div class="target-title">This Month</div>
                                <div id="monthlyTeamLeaderTable" class="mini-table"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Top Performer -->
                <div class="stats-section">
                    <h2 class="section-heading" data-icon="â­">Top Individual Performer <span class="status-pill">Live</span></h2>
                    <div class="leaderboard-card top-performer">
                        <div id="topPerformer" class="performer-info">
                            <p class="no-data">No submissions yet today</p>
                        </div>
                    </div>
                </div>

                <!-- Top Team -->
                <div class="stats-section">
                    <h2 class="section-heading" data-icon="ðŸ‘¥">Top Performing Team <span class="status-pill">Updated today</span></h2>
                    <div class="team-stats" id="teamStats">
                        <p class="no-data">No team data available</p>
                    </div>
                </div>

                <div class="stats-section">
                    <h2 class="section-heading" data-icon="ðŸ§­">Coverage By Area</h2>
                    <div id="areaCoverage" class="coverage-grid"></div>
                </div>

                <div class="stats-section">
                    <h2 class="section-heading" data-icon="âš ï¸">Alerts</h2>
                    <div id="alertPanel" class="alert-panel"></div>
                </div>

                <div class="stats-section">
                    <h2 class="section-heading" data-icon="ðŸ”¥">Team Comparison</h2>
                    <div id="teamHeatmap" class="heatmap-grid"></div>
                </div>

                <div class="stats-section">
                    <h2 class="section-heading" data-icon="ðŸ“¡">Facility Demand Forecast</h2>
                    <div id="facilityForecast" class="forecast-list"></div>
                </div>

                <div class="stats-section">
                    <h2 class="section-heading" data-icon="â°">Punctuality & Attendance</h2>
                    <div class="stats-controls">
                        <div class="stats-search">
                            <select id="attendanceTeamFilter">
                                <option value="ALL">All Teams</option>
                                <option value="Team Thando">Team Thando</option>
                                <option value="Team Thato">Team Thato</option>
                                <option value="Team Rhulani">Team Rhulani</option>
                            </select>
                        </div>
                    </div>
                    <div id="attendancePanel" class="attendance-panel"></div>
                </div>

                <div class="stats-section">
                    <h2 class="section-heading" data-icon="ðŸ§¾">Audit Log</h2>
                    <div id="auditLog" class="audit-log"></div>
                </div>

                <div class="stats-section">
                    <h2 class="section-heading" data-icon="ðŸ“ˆ">Team Trends (Last 7 Days)</h2>
                    <div id="teamTrendChart" class="team-trend"></div>
                </div>

                <!-- Most Productive Facility -->
                <div class="stats-section">
                    <h2 class="section-heading" data-icon="ðŸ¥">Most Productive Facility <span class="status-pill">Today</span></h2>
                    <div class="facility-stats" id="facilityStats">
                        <p class="no-data">No facility data available</p>
                    </div>
                </div>

                <!-- All Individual Rankings -->
                <div class="stats-section">
                    <h2 class="section-heading" data-icon="ðŸ“Œ">Individual Rankings <span class="status-pill">Live</span></h2>
                    <div class="rankings-table" id="individualRankings">
                        <p class="no-data">No rankings available</p>
                    </div>
                </div>
            </div>

            <div class="stats-actions">
                <button class="action-btn secondary" type="button" onclick="resetToLanding()">â† Back to Home</button>
                <button class="action-btn" type="button" onclick="navigateToRegister()">New Registration</button>
                <button class="action-btn" type="button" onclick="exportStatsCsv()">Export CSV</button>
                <button class="action-btn secondary" type="button" onclick="exportStatsPdf()">Export PDF</button>
                <button class="action-btn" type="button" onclick="exportDbdsCsv()">Export DBD CSV</button>
                <button class="action-btn secondary" type="button" onclick="exportDbdsPdf()">Export DBD PDF</button>
                <button class="action-btn secondary" type="button" onclick="navigateToArchives()">View Archives</button>
                <button class="action-btn" type="button" onclick="showCompleteDaySummary()">Complete Day</button>
            </div>

            <div id="completeDayPanel" class="complete-day-panel" style="display: none;">
                <h2 class="section-heading" data-icon="âœ…">Your Monthly Progress</h2>
                <div class="complete-summary" id="completeSummary"></div>
                <div class="complete-graph" id="completeGraph"></div>
                <div class="complete-calendar">
                    <div class="calendar-header" id="calendarHeader"></div>
                    <div class="calendar-grid" id="calendarGrid"></div>
                    <div class="calendar-legend">
                        <span class="legend-chip chip-ok">Present</span>
                        <span class="legend-chip chip-warn">Content</span>
                        <span class="legend-chip chip-danger">Not Productive</span>
                        <span class="legend-chip">Most Productive</span>
                        <span class="legend-chip">Least Productive</span>
                        <span class="legend-chip">Weekend</span>
                        <span class="legend-chip">Absent</span>
                    </div>
                </div>
                <div class="complete-message" id="completeMessage"></div>
            </div>
        </div>
    </section>

    <!-- Page 6: Admin Standalone -->
    <section id="admin-standalone-page" class="page">
        <div class="container">
            <div class="admin-top-shell">
                <div class="page-header">
                    <button class="back-btn" type="button" onclick="resetToLanding()">â† Back to Home</button>
                    <div class="admin-brand-stack">
                        <div class="admin-brand-title">Matla Life Daily Ops â€¢ <span id="adminSiteVersion">v1.0.62</span></div>
                        <img src="matla-life-logo2.png" alt="Matla Life" class="admin-brand-logo" loading="lazy">
                    </div>
                    <div class="section-heading" data-icon="ðŸ›¡ï¸">Admin (All)</div>
                    <h1>Admin Control Center</h1>
                    <p class="page-subtitle">Standalone admin-only page with full access to records and operations.</p>
                    <p class="page-subtitle" id="adminStandaloneScope">Scope: Admin (All)</p>
                </div>
                <div class="admin-standalone-hero">
                    <div class="admin-hero-head">
                        <h2>Master Logger</h2>
                        <p class="page-subtitle">Full control over leads, facilities, register, learning updates, and forms.</p>
                        <p class="page-subtitle admin-hero-sync">Last sync: <span id="adminHeroLastSync">â€”</span></p>
                    </div>
                    <div class="admin-hero-stats">
                        <div class="admin-hero-stat is-clickable" role="button" tabindex="0" data-admin-metric="totalLeads" onclick="openAdminHeroMetric('totalLeads')" aria-label="Open total leads">
                            <span class="admin-hero-value" id="adminHeroTotalLeads">0</span>
                            <span class="admin-hero-label">Total Leads</span>
                        </div>
                        <div class="admin-hero-stat is-clickable" role="button" tabindex="0" data-admin-metric="pendingLeads" onclick="openAdminHeroMetric('pendingLeads')" aria-label="Open pending leads">
                            <span class="admin-hero-value" id="adminHeroPendingLeads">0</span>
                            <span class="admin-hero-label">Pending</span>
                        </div>
                        <div class="admin-hero-stat is-clickable" role="button" tabindex="0" data-admin-metric="jfas" onclick="openAdminHeroMetric('jfas')" aria-label="Open JFA register">
                            <span class="admin-hero-value" id="adminHeroJfas">0</span>
                            <span class="admin-hero-label">JFAs in Register</span>
                        </div>
                        <div class="admin-hero-stat is-clickable" role="button" tabindex="0" data-admin-metric="fasInRegister" onclick="openAdminHeroMetric('fasInRegister')" aria-label="Open FAs in register">
                            <span class="admin-hero-value" id="adminHeroFasInRegister">0</span>
                            <span class="admin-hero-label">FAs In Register</span>
                        </div>
                        <div class="admin-hero-stat is-clickable" role="button" tabindex="0" data-admin-metric="facilities" onclick="openAdminHeroMetric('facilities')" aria-label="Open facilities">
                            <span class="admin-hero-value" id="adminHeroFacilities">0</span>
                            <span class="admin-hero-label">Facilities</span>
                        </div>
                        <div class="admin-hero-stat is-clickable" role="button" tabindex="0" data-admin-metric="needsAssist" onclick="openAdminHeroMetric('needsAssist')" aria-label="Open needs assistance list">
                            <span class="admin-hero-value" id="adminHeroNeedsAssist">0</span>
                            <span class="admin-hero-label">Needs Assistance</span>
                        </div>
                        <div class="admin-hero-stat is-clickable" role="button" tabindex="0" data-admin-metric="openInterventions" onclick="openAdminHeroMetric('openInterventions')" aria-label="Open interventions">
                            <span class="admin-hero-value" id="adminHeroOpenInterventions">0</span>
                            <span class="admin-hero-label">Open Interventions</span>
                        </div>
                        <div class="admin-hero-stat is-clickable" role="button" tabindex="0" data-admin-metric="formsToday" onclick="openAdminHeroMetric('formsToday')" aria-label="Open forms today list">
                            <span class="admin-hero-value" id="adminHeroTodayForms">0</span>
                            <span class="admin-hero-label">Forms Today</span>
                        </div>
                    </div>
                    <div class="menu-page-actions">
                        <button class="action-btn" id="adminHeroTabLeads" type="button" onclick="openAdminStandaloneTab('leads')">Submitted Leads</button>
                        <button class="action-btn secondary" id="adminHeroTabFacilities" type="button" onclick="openAdminStandaloneTab('facilities')">Edit Facilities</button>
                        <button class="action-btn secondary" id="adminHeroTabJfas" type="button" onclick="openAdminStandaloneTab('jfas')">JFA Register</button>
                        <button class="action-btn secondary" id="adminHeroTabFas" type="button" onclick="openAdminStandaloneTab('fas')">FA Register</button>
                        <button class="action-btn secondary" id="adminHeroTabTeams" type="button" onclick="openAdminStandaloneTab('teams')">Team Leaders</button>
                        <button class="action-btn secondary" id="adminHeroTabPerformance" type="button" onclick="openAdminStandaloneTab('performance')">Performance Review</button>
                        <button class="action-btn secondary" id="adminHeroTabClients" type="button" onclick="openAdminStandaloneTab('clients')">Clients (Secure)</button>
                        <button class="action-btn secondary" id="adminHeroTabLearning" type="button" onclick="openAdminStandaloneTab('learning')">Learning Hub</button>
                        <button class="action-btn secondary" id="adminHeroTabForms" type="button" onclick="openAdminStandaloneTab('forms')">Forms Library</button>
                    </div>
                </div>
            </div>
            <div class="stats-section">
                <div class="insight-card">
                    <h4>Master Logger Capabilities</h4>
                    <p class="page-subtitle">Admin (All) can capture, edit, process, and monitor all operations from here.</p>
                    <div class="menu-page-actions">
                        <button class="action-btn secondary" type="button" onclick="openAdminStandaloneTab('jfas')">Register Editing</button>
                        <button class="action-btn secondary" type="button" onclick="openAdminStandaloneTab('fas')">FA Register</button>
                        <button class="action-btn secondary" type="button" onclick="openAdminStandaloneTab('teams')">Team Leader Editing</button>
                        <button class="action-btn secondary" type="button" onclick="openAdminStandaloneTab('performance')">Performance Review</button>
                        <button class="action-btn secondary" type="button" onclick="openAdminStandaloneTab('clients')">Clients (Secure)</button>
                        <button class="action-btn secondary" type="button" onclick="openAdminStandaloneTab('facilities')">Facility Editing</button>
                        <button class="action-btn secondary" type="button" onclick="openAdminStandaloneTab('learning')">Learning Hub Editing</button>
                        <button class="action-btn secondary" type="button" onclick="openAdminStandaloneTab('forms')">Add / Edit Forms</button>
                        <button class="action-btn secondary" type="button" onclick="openAdminStandaloneTab('leads')">Process Leads</button>
                        <button class="action-btn secondary" type="button" onclick="openAdminPaymentsFromStandalone()">Process Payments</button>
                    </div>
                    <div class="menu-page-actions" id="adminStandaloneTeamPortalButtons"></div>
                    <div class="menu-page-actions">
                        <button class="action-btn secondary" type="button" onclick="openAdminMenuStatsFromStandalone()">JFA Individual Stats</button>
                        <button class="action-btn secondary" type="button" onclick="openAdminSettingsFromStandalone()">Security Settings</button>
                    </div>
                </div>
            </div>
            <div class="stats-section">
                <div class="insight-card">
                    <h4>Operational Health</h4>
                    <div class="insight-list" id="adminStandaloneHealth"></div>
                </div>
                <div class="insight-card">
                    <h4>Recent Activity</h4>
                    <div class="audit-log" id="adminStandaloneRecentActivity"></div>
                </div>
            </div>
            <div class="stats-section">
                <div class="menu-page-actions">
                    <button class="action-btn secondary" id="adminStandaloneFacilityDirectoryBtn" type="button" onclick="toggleFacilityDirectory()">Facility Directory</button>
                    <button class="action-btn secondary" type="button" onclick="openNotificationComposeModal('ALL')">Send Notification to Everyone</button>
                    <button class="action-btn secondary" type="button" onclick="openMenuPage('archivedJfas', true, true)">Archived JFAs</button>
                    <button class="action-btn secondary" type="button" onclick="resetAllStats()">Reset All Stats</button>
                    <button class="action-btn secondary" type="button" onclick="openResetModal()">Reset ALL Data</button>
                    <button class="action-btn secondary" type="button" onclick="changeAdminPassword()">Change Admin Password</button>
                    <button class="action-btn secondary" type="button" onclick="logoutAppUser()">Sign Out</button>
                </div>
                <div class="admin-detail-section" id="adminStandaloneMasterLogger"></div>
                <div class="admin-detail-section" id="adminStandaloneNotificationInline" style="display:none;"></div>
                <div class="admin-detail-section" id="adminStandaloneFacilityDirectory"></div>
            </div>
        </div>
    </section>

    <!-- Page 7: Archives -->
    <section id="archives-page" class="page">
        <div class="container">
            <div class="page-header">
                <button class="back-btn" type="button" onclick="navigateToStats()">â† Back</button>
                <div class="section-heading" data-icon="ðŸ—‚">Archives</div>
                <h1>Archives</h1>
                <p class="page-subtitle">Saved daily snapshots</p>
                <p class="page-subtitle" id="archivesScope">Scope: Personal</p>
                <p class="page-subtitle">Last updated: <span id="archivesLastUpdated">â€”</span></p>
            </div>

            <div class="archives-panel">
                <div class="archives-controls">
                    <label for="archiveSelect">Select a day</label>
                    <select id="archiveSelect"></select>
                    <button class="action-btn" type="button" onclick="exportSelectedArchiveCsv()">Export Selected CSV</button>
                    <button class="action-btn secondary" type="button" onclick="exportAllArchivesCsv()">Export All Archives</button>
                </div>
                <div id="archiveSummary" class="archives-summary"></div>
                <div id="archiveTopTeam" class="archives-summary"></div>
                <div id="archiveTeamLeaderboard" class="archives-summary"></div>
                <div id="archiveWeeklyTeamLeaderboard" class="archives-summary"></div>
                <div id="archiveMonthlyTeamLeaderboard" class="archives-summary"></div>
                <div id="archiveTable" class="rankings-table"></div>
            </div>
        </div>
    </section>

    <div id="toast-container" class="toast-container" aria-live="polite" aria-atomic="true"></div>
    <div id="confetti-container" class="confetti-container" aria-hidden="true"></div>
    <div class="quick-actions">
        <button class="quick-actions-toggle" type="button" onclick="toggleQuickActions()" aria-expanded="false" aria-controls="quickActionsMenu">Quick Actions</button>
        <div class="quick-actions-menu" id="quickActionsMenu">
            <button type="button" onclick="navigateToRegister()">Register</button>
            <button type="button" onclick="navigateToDBD()">DBD</button>
            <button type="button" onclick="navigateToStats()">Stats</button>
        </div>
    </div>
    <div id="admin-auth-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="adminAuthTitle" aria-hidden="true" onclick="if(event.target===this) closeAdminAuthModal()">
        <div class="modal-card">
            <div class="admin-auth-brand">
                <img src="new-matla-logo.png" alt="Matla Life" class="menu-logo">
                <div>
                    <h3 id="adminAuthTitle">Admin Access</h3>
                    <p>Enter your username/email and password to continue.</p>
                </div>
            </div>
            <form class="modal-form-grid" onsubmit="event.preventDefault(); submitAdminAccess();">
                <div class="form-group">
                    <label for="adminAuthUsername">Username or Email</label>
                    <input type="text" id="adminAuthUsername" autocomplete="username email" placeholder="Enter username or email">
                </div>
                <div class="form-group">
                    <label for="adminAuthPassword">Password</label>
                    <input type="password" id="adminAuthPassword" autocomplete="current-password" placeholder="Enter password">
                </div>
                <div id="adminAuthError" class="modal-error" style="display:none;"></div>
                <div class="modal-actions">
                    <button class="action-btn secondary" type="button" onclick="openAdminPasswordModalFromAuth()">Settings</button>
                    <button class="action-btn secondary" type="button" onclick="closeAdminAuthModal()">Cancel</button>
                    <button class="action-btn" type="submit">Unlock</button>
                </div>
            </form>
        </div>
    </div>
    <div id="admin-menu-auth-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="adminMenuAuthTitle" aria-hidden="true" onclick="if(event.target===this) closeAdminMenuAuthModal()">
        <div class="modal-card admin-all-access-card">
            <div class="admin-auth-brand">
                <img src="new-matla-logo.png" alt="Matla Life" class="menu-logo">
                <div>
                    <h3 id="adminMenuAuthTitle">Admin Menu Access</h3>
                    <p>Team leaders and Admin can enter with their credentials.</p>
                </div>
            </div>
            <form class="modal-form-grid" onsubmit="event.preventDefault(); submitAdminMenuAccess();">
                <div class="form-group">
                    <label for="adminMenuAuthUsername">Username or Email</label>
                    <input type="text" id="adminMenuAuthUsername" autocomplete="username email" placeholder="Enter username or email">
                </div>
                <div class="form-group">
                    <label for="adminMenuAuthPassword">Password</label>
                    <input type="password" id="adminMenuAuthPassword" autocomplete="current-password" placeholder="Enter password">
                </div>
                <div id="adminMenuAuthError" class="modal-error" style="display:none;"></div>
                <div class="modal-actions">
                    <button class="action-btn secondary" type="button" onclick="closeAdminMenuAuthModal()">Cancel</button>
                    <button class="action-btn" type="submit">Enter Admin Menu</button>
                </div>
            </form>
        </div>
    </div>
    <div id="admin-password-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="adminPasswordTitle" aria-hidden="true" onclick="if(event.target===this) closeAdminPasswordModal()">
        <div class="modal-card">
            <h3 id="adminPasswordTitle">Change Admin Password</h3>
            <p>Keep this password private. Minimum 8 characters with uppercase, lowercase, number, and special character.</p>
            <form class="modal-form-grid" onsubmit="event.preventDefault(); submitAdminPasswordChange();">
                <div class="form-group">
                    <label for="adminCurrentPassword">Current Password</label>
                    <input type="password" id="adminCurrentPassword" autocomplete="current-password">
                </div>
                <div class="form-group">
                    <label for="adminNewPassword">New Password</label>
                    <input type="password" id="adminNewPassword" autocomplete="new-password">
                </div>
                <div class="form-group">
                    <label for="adminConfirmPassword">Confirm New Password</label>
                    <input type="password" id="adminConfirmPassword" autocomplete="new-password">
                </div>
                <div id="adminPasswordError" class="modal-error" style="display:none;"></div>
                <div class="modal-actions">
                    <button class="action-btn secondary" type="button" onclick="closeAdminPasswordModal()">Cancel</button>
                    <button class="action-btn" type="submit">Update Password</button>
                </div>
            </form>
        </div>
    </div>
    <div id="success-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="successModalTitle" aria-hidden="true">
        <div class="modal-card">
            <h3 id="successModalTitle">DBD Submitted</h3>
            <p id="successModalBody">Your submission has been recorded.</p>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" onclick="closeSuccessModal()">Close</button>
                <button class="action-btn" id="successModalPrimaryBtn" type="button" onclick="handleSuccessModalPrimary()">View Stats</button>
            </div>
        </div>
    </div>
    <div id="hero-list-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="heroListTitle" aria-hidden="true">
        <div class="modal-card">
            <h3 id="heroListTitle">Details</h3>
            <input type="text" id="heroListSearch" class="hero-list-search" placeholder="Search names...">
            <div id="heroListBody" class="hero-list-body"></div>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" onclick="closeHeroListModal()">Close</button>
            </div>
        </div>
    </div>
    <div id="hero-jfa-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="heroJfaTitle" aria-hidden="true">
        <div class="modal-card">
            <h3 id="heroJfaTitle">JFA Stats</h3>
            <div id="heroJfaBody" class="hero-jfa-body"></div>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" onclick="closeHeroJfaModal()">Close</button>
            </div>
        </div>
    </div>
    <div id="notification-dropdown" class="notification-dropdown" role="dialog" aria-modal="false" aria-labelledby="notificationTitle" aria-hidden="true">
        <div class="notification-dropdown-card">
            <div class="notification-dropdown-header">
                <h3 id="notificationTitle">Notifications</h3>
                <div class="notification-dropdown-actions">
                    <button class="action-btn secondary" id="notificationMarkReadBtn" type="button" onclick="markAllNotificationsRead()">Mark All as Read</button>
                    <button class="action-btn secondary" id="notificationClearBtn" type="button" onclick="clearVisibleNotifications()">Clear Notifications</button>
                    <button class="action-btn secondary" type="button" onclick="closeNotificationDropdown()">Close</button>
                </div>
            </div>
            <p class="page-subtitle">Team and Admin updates appear here.</p>
            <div class="notification-filter-bar">
                <button class="action-btn secondary notification-filter-btn is-active" id="notificationFilterAllBtn" type="button" onclick="setNotificationFilter('all')">All</button>
                <button class="action-btn secondary notification-filter-btn" id="notificationFilterUnreadBtn" type="button" onclick="setNotificationFilter('unread')">Unread</button>
            </div>
            <div class="insight-list" id="notificationStats"></div>
            <div id="notificationList" class="notification-list"></div>
            <div class="notification-pagination" id="notificationPagination" style="display:none;">
                <button class="action-btn secondary" type="button" id="notificationPrevBtn" onclick="changeNotificationPage(-1)">Previous</button>
                <span class="page-subtitle" id="notificationPageInfo">Page 1 of 1</span>
                <button class="action-btn secondary" type="button" id="notificationNextBtn" onclick="changeNotificationPage(1)">Next</button>
            </div>
        </div>
    </div>
    <div id="notification-detail-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="notificationDetailTitle" aria-hidden="true" onclick="if(event.target===this) closeNotificationDetailModal()">
        <div class="modal-card">
            <h3 id="notificationDetailTitle">Notification</h3>
            <p class="page-subtitle" id="notificationDetailMeta">â€”</p>
            <div id="notificationDetailBody" class="hero-jfa-body"></div>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" onclick="copyNotificationDetail()">Copy Message</button>
                <button class="action-btn secondary" type="button" onclick="closeNotificationDetailModal()">Close</button>
            </div>
        </div>
    </div>
    <div id="notification-clear-confirm-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="notificationClearTitle" aria-hidden="true" onclick="if(event.target===this) closeNotificationClearConfirmModal()">
        <div class="modal-card">
            <h3 id="notificationClearTitle">Clear Notifications?</h3>
            <p>This will remove all notifications currently visible in this view.</p>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" onclick="closeNotificationClearConfirmModal()">Cancel</button>
                <button class="action-btn" type="button" onclick="confirmClearVisibleNotifications()">Clear</button>
            </div>
        </div>
    </div>
    <div id="notification-compose-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="notificationComposeTitle" aria-hidden="true" onclick="if(event.target===this) closeNotificationComposeModal()">
        <div class="modal-card">
            <h3 id="notificationComposeTitle">Send Notification</h3>
            <p class="page-subtitle" id="notificationComposeSubtitle">Share an update with your team.</p>
            <form class="modal-form-grid" onsubmit="event.preventDefault(); submitNotificationCompose();">
                <div class="form-group" id="notificationTeamGroup" style="display:none;">
                    <label for="notificationTeamSelect">Team</label>
                    <select id="notificationTeamSelect"></select>
                </div>
                <div class="form-group">
                    <label for="notificationTitleInput">Title (Optional)</label>
                    <input type="text" id="notificationTitleInput" placeholder="e.g. Morning Push Update">
                </div>
                <div class="form-group">
                    <label for="notificationMessage">Message</label>
                    <textarea id="notificationMessage" rows="4" placeholder="Type your notification..."></textarea>
                </div>
                <div id="notificationComposeError" class="modal-error" style="display:none;"></div>
                <div class="modal-actions">
                    <button class="action-btn secondary" type="button" onclick="closeNotificationComposeModal()">Cancel</button>
                    <button class="action-btn" type="submit">Send Notification</button>
                </div>
            </form>
        </div>
    </div>
    <div id="admin-jfa-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="adminJfaTitle" aria-hidden="true">
        <div class="modal-card">
            <h3 id="adminJfaTitle">JFA Detail</h3>
            <div id="adminJfaBody" class="hero-jfa-body"></div>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" onclick="closeAdminJfaModal()">Close</button>
            </div>
        </div>
    </div>
    <div id="lead-signature-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="leadSignaturePreviewTitle" aria-hidden="true" onclick="if(event.target===this) closeLeadSignaturePreview()">
        <div class="modal-card">
            <h3 id="leadSignaturePreviewTitle">Client Signature (Admin Only)</h3>
            <p class="page-subtitle" id="leadSignaturePreviewMeta">â€”</p>
            <div class="lead-signature-preview-wrap">
                <img id="leadSignaturePreviewImage" class="lead-signature-preview-image" src="" alt="Client signature preview">
            </div>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" onclick="closeLeadSignaturePreview()">Close</button>
            </div>
        </div>
    </div>
    <div id="reset-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="resetModalTitle" aria-hidden="true">
        <div class="modal-card">
            <h3 id="resetModalTitle">Reset All Data?</h3>
            <p>This will permanently delete registrations, DBDs, archives, and stats. Type <strong>DELETE ALL DATA</strong> to confirm.</p>
            <div class="form-group">
                <input type="text" id="resetDataConfirmInput" placeholder="Type DELETE ALL DATA">
            </div>
            <div id="resetDataConfirmError" class="modal-error" style="display:none;"></div>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" onclick="closeResetModal()">Cancel</button>
                <button class="action-btn" type="button" onclick="confirmResetAllDataFromModal()">Reset All Data</button>
            </div>
        </div>
    </div>
    <div id="reset-stats-confirm-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="resetStatsTitle" aria-hidden="true" onclick="if(event.target===this) closeResetStatsConfirmModal()">
        <div class="modal-card">
            <h3 id="resetStatsTitle">Reset All Stats?</h3>
            <p>This will reset all consent form totals to 0 while keeping users. Type <strong>RESET STATS</strong> to confirm.</p>
            <div class="form-group">
                <input type="text" id="resetStatsConfirmInput" placeholder="Type RESET STATS">
            </div>
            <div id="resetStatsConfirmError" class="modal-error" style="display:none;"></div>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" onclick="closeResetStatsConfirmModal()">Cancel</button>
                <button class="action-btn" type="button" onclick="confirmResetAllStatsFromModal()">Reset Stats</button>
            </div>
        </div>
    </div>
    <div id="global-search-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="globalSearchTitle" aria-hidden="true" onclick="if(event.target===this) closeGlobalSearch()">
        <div class="modal-card">
            <h3 id="globalSearchTitle">Quick Search</h3>
            <p class="page-subtitle">Search JFAs, leads, LIDs, facilities, and payments.</p>
            <div class="form-group">
                <input type="text" id="globalSearchInput" placeholder="Type a name, LID, team, or facility..." autocomplete="off">
            </div>
            <div id="globalSearchResults" class="learning-search-results"></div>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" onclick="closeGlobalSearch()">Close</button>
            </div>
        </div>
    </div>
    <div id="signout-confirm-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="signOutTitle" aria-hidden="true" onclick="if(event.target===this) closeSignOutConfirmModal()">
        <div class="modal-card">
            <h3 id="signOutTitle">Sign out?</h3>
            <p>You will need your username/email and password to sign back in.</p>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" data-signout-cancel onclick="closeSignOutConfirmModal()">Cancel</button>
                <button class="action-btn" type="button" onclick="confirmSignOutNow()">Sign Out</button>
            </div>
        </div>
    </div>
    <div id="app-confirm-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="appConfirmTitle" aria-hidden="true" onclick="if(event.target===this) closeAppConfirmModal(false)">
        <div class="modal-card">
            <h3 id="appConfirmTitle">Confirm Action</h3>
            <p id="appConfirmMessage">Are you sure?</p>
            <div class="modal-actions">
                <button class="action-btn secondary" id="appConfirmCancelBtn" type="button" onclick="closeAppConfirmModal(false)">Cancel</button>
                <button class="action-btn" id="appConfirmOkBtn" type="button" onclick="closeAppConfirmModal(true)">Confirm</button>
            </div>
        </div>
    </div>
    <div id="ben-export-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="benExportTitle" aria-hidden="true" onclick="if(event.target===this) closeBenExportModal()">
        <div class="modal-card">
            <h3 id="benExportTitle">Ben System Export</h3>
            <p id="benExportMessage">Your export is ready.</p>
            <div class="modal-actions">
                <button class="action-btn" type="button" onclick="closeBenExportModal()">Close</button>
            </div>
        </div>
    </div>
    <div id="export-reason-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="exportReasonTitle" aria-hidden="true" onclick="if(event.target===this) closeExportReasonModal(true)">
        <div class="modal-card export-reason-card">
            <h3 id="exportReasonTitle">Export Reason Window</h3>
            <p id="exportReasonPrompt">Export reason for "Data Export" (minimum 5 characters):</p>
            <div class="form-group">
                <label for="exportReasonInput">Reason</label>
                <input type="text" id="exportReasonInput" placeholder="Type reason..." minlength="5" maxlength="240">
            </div>
            <div id="exportReasonError" class="modal-error" style="display:none;"></div>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" onclick="closeExportReasonModal(true)">Cancel</button>
                <button class="action-btn" type="button" onclick="submitExportReasonModal()">Continue Export</button>
            </div>
        </div>
    </div>
    <div id="fa-attendance-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="faAttendanceTitle" aria-hidden="true" onclick="if(event.target===this) closeFaAttendanceModal()">
        <div class="modal-card">
            <h3 id="faAttendanceTitle">FA Register</h3>
            <p>Mark Financial Advisor attendance for today.</p>
            <div class="form-group">
                <label for="faAttendanceSelect">Select FA</label>
                <select id="faAttendanceSelect"></select>
            </div>
            <div class="form-group">
                <label for="faAttendanceName">Or enter FA name</label>
                <input type="text" id="faAttendanceName" placeholder="e.g. John Doe">
            </div>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" onclick="closeFaAttendanceModal()">Cancel</button>
                <button class="action-btn" type="button" onclick="submitFaAttendance()">Mark Present</button>
            </div>
            <p class="page-subtitle" id="faAttendanceHint" style="margin-top:8px;">Attendance only. No extra personal details are captured here.</p>
        </div>
    </div>
    <div id="forgot-password-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="forgotPasswordTitle" aria-hidden="true" onclick="if(event.target===this) closeForgotPasswordModal()">
        <div class="modal-card">
            <h3 id="forgotPasswordTitle">Reset Your Password</h3>
            <p>Enter your email address. We'll send you a reset link.</p>
            <form class="modal-form-grid" onsubmit="event.preventDefault(); submitForgotPassword();">
                <div class="form-group">
                    <label for="forgotPasswordEmail">Email Address</label>
                    <input type="email" id="forgotPasswordEmail" autocomplete="email" placeholder="name@example.com">
                </div>
                <div class="insight-list" id="forgotPasswordDiag" style="gap:8px;">
                    <span class="insight-chip" id="forgotDiagApi">API: checkingâ€¦</span>
                    <span class="insight-chip" id="forgotDiagSmtp">SMTP: checkingâ€¦</span>
                    <span class="insight-chip" id="forgotDiagAccount">Account: enter email</span>
                </div>
                <div id="forgotPasswordError" class="modal-error" style="display:none;"></div>
                <div class="modal-actions">
                    <button class="action-btn secondary" type="button" onclick="closeForgotPasswordModal()">Cancel</button>
                    <button class="action-btn" type="submit">Send Reset Link</button>
                </div>
            </form>
        </div>
    </div>
    <div id="reset-password-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="resetPasswordTitle" aria-hidden="true" onclick="if(event.target===this) closeResetPasswordModal()">
        <div class="modal-card">
            <h3 id="resetPasswordTitle">Create New Password</h3>
            <p>Choose a new password for your account (8+ chars, uppercase, lowercase, number, special character).</p>
            <form class="modal-form-grid" onsubmit="event.preventDefault(); submitResetPassword();">
                <div class="form-group">
                    <label for="resetPasswordNew">New Password</label>
                    <input type="password" id="resetPasswordNew" autocomplete="new-password" placeholder="New password">
                </div>
                <div class="form-group">
                    <label for="resetPasswordConfirm">Confirm Password</label>
                    <input type="password" id="resetPasswordConfirm" autocomplete="new-password" placeholder="Confirm new password">
                </div>
                <div id="resetPasswordError" class="modal-error" style="display:none;"></div>
                <div class="modal-actions">
                    <button class="action-btn secondary" type="button" onclick="closeResetPasswordModal()">Cancel</button>
                    <button class="action-btn" type="submit">Update Password</button>
                </div>
            </form>
        </div>
    </div>
    <div id="policy-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="policyTitle" aria-hidden="true" onclick="if(event.target===this) closePolicyModal()">
        <div class="modal-card">
            <h3 id="policyTitle">Client Data Confidentiality Policy</h3>
            <p>By creating an account, you confirm you will handle client data with strict confidentiality and follow Matla Life procedures, aligned with the Protection of Personal Information Act (POPIA).</p>
            <ul>
                <li>Do not share client details outside authorized channels.</li>
                <li>Use captured data only for approved applications and follow-ups.</li>
                <li>Report any data issues to your team leader or Admin (All).</li>
                <li>Collect only the minimum client information required to do the job.</li>
                <li>Keep personal information secure and confidential at all times.</li>
                <li>Clients have a right to access and correct their information.</li>
            </ul>
            <p class="page-subtitle">POPIA is a South African law that sets conditions for lawful processing, accountability, and security safeguards for personal information.</p>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" onclick="closePolicyModal()">Close</button>
            </div>
        </div>
    </div>
    <div id="shortcuts-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="shortcutsTitle" aria-hidden="true" onclick="if(event.target===this) closeShortcutsModal()">
        <div class="modal-card">
            <h3 id="shortcutsTitle">Keyboard Shortcuts</h3>
            <div class="mini-table">
                <table>
                    <thead><tr><th>Shortcut</th><th>Action</th></tr></thead>
                    <tbody>
                        <tr><td><strong>Alt+1</strong></td><td>Open Admin</td></tr>
                        <tr><td><strong>Alt+2</strong></td><td>Open Learning Hub</td></tr>
                        <tr><td><strong>Alt+3</strong></td><td>Open Forms</td></tr>
                        <tr><td><strong>Alt+4</strong></td><td>Open Leads</td></tr>
                        <tr><td><strong>Alt+5</strong></td><td>Open Appointments</td></tr>
                        <tr><td><strong>Alt+6</strong></td><td>Open Payments (Alignments)</td></tr>
                        <tr><td><strong>Alt+7</strong></td><td>Open Ben System</td></tr>
                        <tr><td><strong>Alt+0</strong></td><td>Close menu page</td></tr>
                        <tr><td><strong>?</strong></td><td>Open this shortcuts window</td></tr>
                        <tr><td><strong>Esc</strong></td><td>Close active modal</td></tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-actions">
                <button class="action-btn secondary" type="button" onclick="closeShortcutsModal()">Close</button>
            </div>
        </div>
    </div>
    <div id="team-auth-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="teamAuthTitle" aria-hidden="true" onclick="if(event.target===this) closeTeamAuthModal()">
        <div class="modal-card">
            <h3 id="teamAuthTitle">Team Portal Access</h3>
            <p class="page-subtitle" id="teamAuthSubtitle">Enter your credentials to continue.</p>
            <form class="modal-form-grid" onsubmit="event.preventDefault(); submitTeamPortalAccess();">
                <div class="form-group">
                    <label for="teamAuthUsername">Username or Email</label>
                    <input type="text" id="teamAuthUsername" autocomplete="username email" placeholder="Enter username or email">
                </div>
                <div class="form-group">
                    <label for="teamAuthPassword">Password</label>
                    <input type="password" id="teamAuthPassword" autocomplete="current-password" placeholder="Enter password">
                </div>
                <div id="teamAuthError" class="modal-error" style="display:none;"></div>
                <div class="modal-actions">
                    <button class="action-btn secondary" type="button" onclick="closeTeamAuthModal()">Cancel</button>
                    <button class="action-btn" type="submit">Enter Team Portal</button>
                </div>
            </form>
        </div>
    </div>
    <div id="clients-access-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="clientsAccessTitle" aria-hidden="true" onclick="if(event.target===this) closeClientsAccessModal(false)">
        <div class="modal-card">
            <h3 id="clientsAccessTitle">Clients Access</h3>
            <p class="page-subtitle">Enter your password to open the confidential Clients section.</p>
            <form class="modal-form-grid" onsubmit="event.preventDefault(); submitClientsAccessModal();">
                <div class="form-group">
                    <label for="clientsAccessPassword">Password</label>
                    <input type="password" id="clientsAccessPassword" autocomplete="current-password" placeholder="Enter password">
                </div>
                <div id="clientsAccessError" class="modal-error" style="display:none;"></div>
                <div class="modal-actions">
                    <button class="action-btn secondary" type="button" onclick="closeClientsAccessModal(false)">Cancel</button>
                    <button class="action-btn" type="submit">Open Clients</button>
                </div>
            </form>
        </div>
    </div>
    <div id="pageTransitionOverlay" class="page-transition-overlay" aria-hidden="true"></div>
    <footer class="mobile-contact-footer" aria-label="Business hours and contact">
        <span>Mon - Fri 8:00-17:30</span>
        <span>+27 (0) 10 065 2659</span>
    </footer>

    <script>
        // Secure API config (update these values in production)
        window.JFA_API_BASE = window.JFA_API_BASE || (
            window.location.protocol === 'file:' ? 'http://localhost:8081' : window.location.origin
        );
        window.JFA_API_TOKEN = window.JFA_API_TOKEN || 'change_me_super_long_random_token';
        window.JFA_DB_SCOPE = window.JFA_DB_SCOPE || 'matla-life-default';
    </script>
    <script src="Ops.js?v=140"></script>
    <script>
        if ('IntersectionObserver' in window) {
            const revealTargets = document.querySelectorAll('.summary-card, .about-card, .service-item, .registration-form-container, .dbd-form-container, .stats-section, .archives-panel, .assignment-card, .lead-panel, .lead-section, .target-card, .insight-card');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach((entry) => {
                    if (!entry.isIntersecting) return;
                    entry.target.classList.add('is-visible');
                    observer.unobserve(entry.target);
                });
            }, { threshold: 0.15 });
            revealTargets.forEach((el, idx) => {
                el.style.transitionDelay = `${Math.min(idx * 40, 240)}ms`;
                observer.observe(el);
            });
        }
    </script>
</body>
</html>
